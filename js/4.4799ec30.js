(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{2:function(a,t){},"20c0":function(a,t,e){},"23ff":function(a,t,e){"use strict";var o=e("20c0"),i=e.n(o);i.a},3:function(a,t){},a00b:function(a,t,e){"use strict";e.r(t);var o=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("q-page",{staticClass:"constrain-more q-pa-md"},[e("div",{staticClass:"camara-frame q-pa-md"},[e("Video",{directives:[{name:"show",rawName:"v-show",value:!a.imageCaptured,expression:"!imageCaptured"}],ref:"video",staticClass:"full-width",attrs:{autoplay:"",playsinline:""}}),e("canvas",{directives:[{name:"show",rawName:"v-show",value:a.imageCaptured,expression:"imageCaptured"}],ref:"canvas",staticClass:"full-width",attrs:{height:"240"}})],1),e("div",{staticClass:"text-center q-pa-md"},[e("q-btn",{directives:[{name:"show",rawName:"v-show",value:a.hasCameraSupport&&!a.showReloadCamera,expression:"hasCameraSupport && !showReloadCamera"}],attrs:{round:"",color:"grey-10",size:"lg",icon:"eva-camera"},on:{click:a.captureImage}}),e("q-btn",{directives:[{name:"show",rawName:"v-show",value:a.hasCameraSupport&&a.showReloadCamera,expression:"hasCameraSupport && showReloadCamera"}],attrs:{round:"",color:"grey-10",size:"lg",icon:"eva-refresh"},on:{click:a.reLoadCamera}}),e("q-file",{directives:[{name:"show",rawName:"v-show",value:!a.hasCameraSupport,expression:"!hasCameraSupport"}],attrs:{label:"Choose an Image",outlined:"",accept:"image/*"},on:{input:a.captureImageFallback},scopedSlots:a._u([{key:"prepend",fn:function(){return[e("q-icon",{attrs:{name:"eva-attach-outline"}})]},proxy:!0}]),model:{value:a.imageUpload,callback:function(t){a.imageUpload=t},expression:"imageUpload"}}),e("div",{staticClass:"row justify-center q-ma-md"},[e("q-input",{staticClass:"col col-sm-6",attrs:{label:"Caption",dense:""},model:{value:a.post.caption,callback:function(t){a.$set(a.post,"caption",t)},expression:"post.caption"}})],1),e("div",{staticClass:"row justify-center q-ma-md"},[e("q-input",{staticClass:"col col-sm-6",attrs:{label:"Category",type:"number",dense:""},model:{value:a.post.category,callback:function(t){a.$set(a.post,"category",t)},expression:"post.category"}})],1),e("div",{staticClass:"row justify-center q-ma-md"},[e("q-input",{staticClass:"col col-sm-6",attrs:{loading:a.locationLoading,label:"Location",dense:""},scopedSlots:a._u([{key:"append",fn:function(){return[!a.locationLoading&&a.locationSupported?e("q-btn",{directives:[{name:"show",rawName:"v-show",value:!a.showReloadLocation,expression:"!showReloadLocation"}],attrs:{icon:"eva-navigation-2-outline",round:"",dense:"",flat:""},on:{click:a.getLocation}}):a._e()]},proxy:!0}]),model:{value:a.post.location,callback:function(t){a.$set(a.post,"location",t)},expression:"post.location"}})],1),e("div",{staticClass:"row justify-center q-mt-lg"},[e("q-btn",{attrs:{unelevated:"",rounded:"",color:"primary",label:"Post Image"},on:{click:a.submitTrend}})],1)],1)])},i=[],n=(e("99af"),e("4160"),e("e260"),e("c19f"),e("ace4"),e("d3b7"),e("ac1f"),e("1276"),e("5cc6"),e("9a8c"),e("a975"),e("735e"),e("c1ac"),e("d139"),e("3a7b"),e("d5d6"),e("82f8"),e("e91f"),e("60bd"),e("5f96"),e("3280"),e("3fcc"),e("ca91"),e("25a1"),e("cd26"),e("3c5d"),e("2954"),e("649e"),e("219c"),e("170b"),e("b39a"),e("72f7"),e("159b"),e("ded3")),s=e.n(n),r=e("1732"),c=(e("d485"),e("2f62"));e("121f");var l={name:"PageCamera",data:function(){return{post:{_id:Object(r["a"])(),caption:"",location:"",category:"",photoUrl:"",photo:null,date:Date.now()},imageCaptured:!1,imageUpload:[],locationLoading:!1,showReloadLocation:!1,showReloadCamera:!1,hasCameraSupport:!0}},computed:{locationSupported:function(){return"geolocation"in navigator}},methods:s()(s()({},Object(c["b"])(["createTrend"])),{},{initCamara:function(){var a=this;navigator.mediaDevices.getUserMedia({video:!0}).then((function(t){a.$refs.video.srcObject=t})).catch((function(t){a.hasCameraSupport=!1,alert("May the browser didn't support or there is some errors.")}))},submitTrend:function(){console.log(this.post),this.createTrend(this.post)},captureImage:function(){this.showReloadCamera=!0,console.log("capture iage");var a=this.$refs.video,t=this.$refs.canvas;t.width=a.getBoundingClientRect().width,t.height=a.getBoundingClientRect().height;var e=t.getContext("2d");e.drawImage(a,0,0,t.width,t.height),this.imageCaptured=!0,this.post.photo=this.dataURItoBlob(t.toDataURL()),console.log(t.toDataURL())},reLoadCamera:function(){console.log("reloading..."),this.showReloadCamera=!1,this.imageCaptured=!1,this.initCamara()},disableCamera:function(){this.$refs.video.srcObject.getVideoTracks().forEach((function(a){a.stop()}))},captureImageFallback:function(a){var t=this;this.post.photo=a;var e=this.$refs.canvas,o=e.getContext("2d"),i=new FileReader;i.onload=function(a){var i=new Image;i.onload=function(){e.width=i.width,e.height=i.height,o.drawImage(i,0,0),t.imageCaptured=!0},i.src=a.target.result},i.readAsDataURL(a)},dataURItoBlob:function(a){for(var t=atob(a.split(",")[1]),e=a.split(",")[0].split(":")[1].split(";")[0],o=new ArrayBuffer(t.length),i=new Uint8Array(o),n=0;n<t.length;n++)i[n]=t.charCodeAt(n);var s=new Blob([o],{type:e});return s},getLocation:function(){var a=this;this.locationLoading=!0,this.showReloadLocation=!0,navigator.geolocation.getCurrentPosition((function(t){a.getCityAndCountry(t)}),(function(t){a.locationError()}),{timeout:7e3})},getCityAndCountry:function(a){var t=this,e="https://geocode.xyz/".concat(a.coords.latitude,",").concat(a.coords.longitude,"?json=1");this.$axios.get(e).then((function(a){t.locationSuccess(a)})).catch((function(a){t.locationError()}))},locationSuccess:function(a){this.post.location=a.data.city,console.log(a),a.data.region&&(this.post.location+=", ".concat(a.data.region)),this.locationLoading=!1},locationError:function(){this.$q.dialog({title:"Error",message:"could not found location"}),this.locationLoading=!1,this.showReloadLocation=!1}}),mounted:function(){this.initCamara()},beforeDestroy:function(){this.hasCameraSupport&&this.disableCamera()}},d=l,u=(e("23ff"),e("2877")),p=e("9989"),h=e("9c40"),m=e("7d53"),g=e("0016"),f=e("27f9"),v=e("eebe"),C=e.n(v),w=Object(u["a"])(d,o,i,!1,null,null,null);t["default"]=w.exports;C()(w,"components",{QPage:p["a"],QBtn:h["a"],QFile:m["a"],QIcon:g["a"],QInput:f["a"]})}}]);